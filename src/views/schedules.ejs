<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>VTubers Schedules - ihateani.me</title>
    <meta name="description" content="VTuber Stream Schedules data using ihateani.me API v2">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- OpenGraph -->
    <meta property="og:title" content="VTuber Schedules">
    <meta property="og:description" content="VTuber Stream Schedules data using ihateani.me API v2">
    <meta property="og:url" content="https://vtuber.ihateani.me/schedules">
    <meta property="og:site_name" content="ihateani.me API">
    <meta property="og:image" content="/assets/favicon.png">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#383838">

    <!-- Preconnect -->
    <link rel="preconnect" href="https://i.ytimg.com">
    <link rel="preconnect" href="https://api.ihateani.me">
    <link rel="dns-prefetch" href="https://i.ytimg.com">
    <link rel="dns-prefetch" href="https://api.ihateani.me">

    <link rel="icon" type="image/png" href="/assets/favicon.png">
    <link rel="icon" href="/assets/favicon.ico">

    <!-- Preload some CSS -->
    <style type="text/css">
        *,:after,:before{-webkit-box-sizing:border-box;box-sizing:border-box}:root{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-gray:#757575;--bs-gray-dark:#4f4f4f;--bs-primary:#1266f1;--bs-secondary:#b23cfd;--bs-success:#00b74a;--bs-info:#39c0ed;--bs-warning:#ffa900;--bs-danger:#f93154;--bs-light:#fbfbfb;--bs-dark:#262626;--bs-white:#fff;--bs-black:#000;--bs-font-sans-serif:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--bs-gradient:linear-gradient(180deg,hsla(0,0%,100%,0.15),hsla(0,0%,100%,0))}:root{scroll-behavior:smooth}:root{--mdb-font-roboto:"Roboto",sans-serif}body{margin:0;font-size:1rem;font-weight:400;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{font-family:var(--mdb-font-roboto);line-height:1.6;color:#4f4f4f}.navbar{position:relative;-ms-flex-wrap:wrap;flex-wrap:wrap;padding-top:.5rem;padding-bottom:.5rem}.navbar,.navbar>.container,.navbar>.container-fluid,.navbar>.container-lg,.navbar>.container-md,.navbar>.container-sm,.navbar>.container-xl,.navbar>.container-xxl{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.sticky-top{position:sticky;top:0;z-index:1020}.bg-dark{background-color:#262626!important}.navbar{-webkit-box-shadow:0 10px 20px 0 rgba(0,0,0,.05);box-shadow:0 10px 20px 0 rgba(0,0,0,.05);padding-top:.5625rem}.container,.container-fluid,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{width:100%;padding-right:var(--bs-gutter-x,.75rem);padding-left:var(--bs-gutter-x,.75rem);margin-right:auto;margin-left:auto}.navbar>.container,.navbar>.container-fluid,.navbar>.container-lg,.navbar>.container-md,.navbar>.container-sm,.navbar>.container-xl,.navbar>.container-xxl{-ms-flex-wrap:inherit;flex-wrap:inherit}a{color:#1266f1;text-decoration:underline}a{text-decoration:none}.navbar-brand{padding-top:.3rem;padding-bottom:.3rem;margin-right:1rem;font-size:1.25rem;text-decoration:none;white-space:nowrap}.navbar-brand{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.navbar-dark .navbar-brand,.navbar-dark .navbar-brand:focus,.navbar-dark .navbar-brand:hover{color:#fff}button{border-radius:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}.navbar-toggler{padding:.25rem .75rem;font-size:1.25rem;line-height:1;background-color:transparent;border:1px solid transparent;border-radius:.25rem;-webkit-transition:-webkit-box-shadow .15s ease-in-out;transition:-webkit-box-shadow .15s ease-in-out;transition:box-shadow .15s ease-in-out;transition:box-shadow .15s ease-in-out,-webkit-box-shadow .15s ease-in-out}.border{border:1px solid #e0e0e0!important}.border-2{border-width:2px!important}.navbar-toggler{border:0}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}.navbar-dark .navbar-toggler{color:hsla(0,0%,100%,.55);border-color:hsla(0,0%,100%,.1)}.navbar-dark .navbar-toggler,.navbar-light .navbar-toggler{border:0}.navbar-collapse{-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.justify-content-between{-webkit-box-pack:justify!important;-ms-flex-pack:justify!important;justify-content:space-between!important}.collapse:not(.show){display:none}.mt-4{margin-top:1.5rem!important}.pb-4{padding-bottom:1.5rem!important}.text-center{text-align:center!important}.spinner-grow{display:inline-block;width:2rem;height:2rem;vertical-align:text-bottom;background-color:currentColor;border-radius:50%;opacity:0;-webkit-animation:spinner-grow .75s linear infinite;animation:spinner-grow .75s linear infinite}.text-white{color:#fff!important}.visually-hidden,.visually-hidden-focusable:not(:focus){position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}p{margin-top:0;margin-bottom:1rem}.mt-2{margin-top:.5rem!important}.fade{-webkit-transition:opacity .15s linear;transition:opacity .15s linear}.modal{position:fixed;top:0;left:0;z-index:1050;display:none;width:100%;height:100%;overflow:hidden;outline:0}.fade:not(.show){opacity:0}.text-muted{color:#757575!important}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}.p-3{padding:1rem!important}b,strong{font-weight:bolder}
    </style>

    <!-- CSS Preloading -->
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/assets/css/ihaiconsv2.3.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <!-- Fallback -->
    <noscript>
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.css" rel="stylesheet" />
        <link href="/assets/css/ihaiconsv2.3.css" rel="stylesheet">
    </noscript>
    <style type="text/css">
        .bg-darkgrey,.btn-darkgrey{background-color:#2a2d2f!important}.btn-darkgrey:active,.btn-darkgrey:focus,.btn-darkgrey:hover{background-color:#35383a!important}.text-darkgrey{color:#2a2d2f!important}.text-twitch{color:#8e42fe!important}.text-twcast{color:#027af8!important}.text-bili2{color:#00a1d6!important}.text-mildom{color:#38cce3!important}.border-twitch{border-color:#8e42fe!important}.border-twcast{border-color:#027af8!important}.border-bili2{border-color:#00a1d6!important}.border-mildom{border-color:#38cce3!important}.floating-btn{position:fixed;width:60px;height:60px;bottom:40px;right:40px;background-color:#c50909;color:#fff;border-radius:50px;text-align:center;box-shadow:0 0 5px 0 #2a2d2f;border-color:transparent;z-index:999}
    </style>
    <style type="text/css">
        ::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-button{width:0;height:0}::-webkit-scrollbar-thumb{background:#4d4d4d;border:3px none grey;border-radius:50px}::-webkit-scrollbar-thumb:hover{background:#7a7a7a}::-webkit-scrollbar-thumb:active{background:#2e2e2e}::-webkit-scrollbar-track{background:#707070;border:0 none #fff;border-radius:100px}::-webkit-scrollbar-track:hover{background:#666}::-webkit-scrollbar-track:active{background:#666}::-webkit-scrollbar-corner{background:0 0}
    </style>
</head>

<body class="bg-darkgrey">
    <nav id="main-nav" class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">VTuber API</a>
            <button class="navbar-toggler border border-2" style="border-color: #525252 !important;" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNavDarkDropdown" aria-controls="navbarNavDarkDropdown" aria-expanded="false"
                aria-label="Toggle navigation">
                <i class="ihaicon">menu</i>
            </button>
            <div class="collapse navbar-collapse justify-content-between" id="navbarNavDarkDropdown">
                <div class="navbar-nav">
                    <a class="nav-link" href="/">Home</a>
                    <a class="nav-link" href="/lives">Lives</a>
                    <a class="nav-link active" aria-current="page" href="#">Schedule</a>
                    <a class="nav-link" href="/playground"><i class="ihaicon me-1">graphql_icon</i>Playground</a>
                </div>
                <div class="navbar-nav">
                    <a class="nav-link" href="/settings"><i class="ihaicon">settings</i></a>
                    <a class="nav-link" href="/admin"><i class="ihaicon">sign_in</i></a>
                </div>
            </div>
        </div>
    </nav>
    <div id="main" class="container-fluid mt-4 pb-4">
        <div id="loading-signal" class="text-center">
            <div class="spinner-grow text-white" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p id="loading-text" class="mt-2 text-white">Loading...</p>
        </div>
        <div id="group-modal" class="modal fade" tabindex="-1">
            <div class="modal-dialog modal-dialog-scrollable">
                <div class="modal-content bg-dark text-white">
                    <div class="modal-header border-dark">
                        <h5 class="modal-title">Groups</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <div id="group-modal-grid" class="d-grid gap-2">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button id="group-btn-modal" type="button" data-bs-toggle="modal" data-bs-target="#group-modal"
            class="floating-btn">
            <i class="ihaicon">peoples</i>
        </button>
    </div>
    <footer class="text-center text-lg-start text-muted">
        <hr>
        <div class="text-center p-3" class="bg-darkgrey">
            Created by <b>N4O#8868</b><br>
            © 2020-2021
            <a class="text-white" href="https://ihateani.me/">ihateani.me</a>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous">
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@1.25.0/build/global/luxon.min.js"
        integrity="sha256-OVk2fwTRcXYlVFxr/ECXsakqelJbOg5WCj1dXSIb+nU=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.3.0/dist/lazyload.min.js"></script>
    <script type="text/javascript">
        "use strict"

        const $dropdown = $("#group-dropdown");
        const $main = $("#main");
        const $loader = $("#loading-signal");
        const $gridModal = $("#group-modal-grid");
        var fetchedPage = 0;
        const DateTime = luxon.DateTime;
        const localZone = localStorage.getItem("vtapi-offsetLoc") || "UTC" + DateTime.local().toFormat("ZZ");

        if (localStorage.getItem("vtapi-offsetLoc") === null) {
            console.info(`Setting default timezone to ${localZone}!`)
            localStorage.setItem("vtapi-offsetLoc", localZone);
        }

        let gqlSchemas = `query VTuberSchedule($cursor:String) {
            vtuber {
                upcoming(cursor:$cursor,limit:75,platforms:[youtube]) {
                    _total
                    items {
                        id
                        title
                        channel {
                            id
                            name
                            image
                        }
                        timeData {
                            scheduledStartTime
                        }
                        thumbnail
                        platform
                        is_premiere
                        group
                    }
                    pageInfo {
                        results_per_page
                        hasNextPage
                        nextCursor
                    }
                }
            }
        }`;

        let GROUPS_NAME_MAP = {
            "animare": "Animare",
            "axel-v": "AXEL-V",
            "cattleyarg": "Cattleya Regina Games",
            "dotlive": ".LIVE",
            "eilene": "Eilene",
            "entum": "ENTUM",
            "hanayori": "Hanayori",
            "hololive": "Hololive",
            "hololiveen": "Hololive English",
            "hololivecn": "Hololive China",
            "hololiveid": "Hololive Indonesia",
            "holostars": "Holostars",
            "honeystrap": "Honeystrap",
            "irisbg": "Iris Black Games",
            "kamitsubaki": "KAMITSUBAKI Studio",
            "kizunaai": "Kizuna Ai Co.",
            "lupinusvg": "Lupinus Video Games",
            "mahapanca": "MAHA5",
            "nijisanji": "NIJISANJI",
            "nijisanjiid": "NIJISANJI Indonesia",
            "nijisanjiin": "NIJISANJI India",
            "nijisanjikr": "NIJISANJI Korea",
            "nijisanjien": "NIJISANJI English",
            "noriopro": "Norio Production",
            "paryiproject": "Paryi Project",
            "solovtuber": "Solo/Indie",
            "sugarlyric": "SugarLyric",
            "tsunderia": "Tsunderia",
            "upd8": "upd8",
            "vapart": "VAPArt",
            "veemusic": "VEEMusic",
            "vgaming": "VGaming",
            "vic": "VIC",
            "virtuareal": "VirtuaReal",
            "vivid": "ViViD",
            "voms": "VOMS",
            "vspo": "VTuber eSports Project",
            "vshojo": "VShojo"
        }

        // Modified version of:
        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce#Grouping_objects_by_a_property
        function groupBy(objectArray, property) {
            return objectArray.reduce(function (acc, obj) {
                let key;
                if (typeof property === "function") {
                    key = property(obj);
                } else {
                    key = obj[property];
                }
                if (!acc[key]) {
                    acc[key] = []
                }
                acc[key].push(obj)
                return acc
            }, {})
        }

        // https://github.com/you-dont-need/You-Dont-Need-Lodash-Underscore#_get
        function get(obj, path, defaults = undefined) {
            const travel = regexp =>
                String.prototype.split
                .call(path, regexp)
                .filter(Boolean)
                .reduce((res, key) => (res !== null && res !== undefined ? res[key] : res), obj);
            const result = travel(/[,[\]]+?/) || travel(/[,[\].]+?/);
            return result === undefined || result === obj ? defaults : result;
        }

        // Modified version of:
        // https://github.com/you-dont-need/You-Dont-Need-Lodash-Underscore#_sortby-and-_orderby
        function sortBy(data, key_or_func) {
            if (typeof data === "undefined" || data === null) {
                return data;
            }
            if (data.length < 1) {
                return data;
            }
            let result = data.concat().sort((a, b) => {
                let a1, b1;
                if (typeof key_or_func === "function") {
                    a1 = key_or_func(a);
                    b1 = key_or_func(b);
                } else {
                    a1 = a[key_or_func];
                    b1 = b[key_or_func];
                }
                return (a1 > b1) ? 1 : ((b1 > a1) ? -1 : 0);
            })
            return result;
        }

        const getLives = async function (cursor = "") {
            let apiRes = await fetch("https://api.ihateani.me/v2/graphql", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json"
                },
                body: JSON.stringify({
                    query: gqlSchemas,
                    variables: {
                        cursor: cursor
                    }
                })
            }).then((res) => res.json());
            return apiRes;
        }

        const getAllLivesAsync = async function (cursor = "") {
            let results = await getLives(cursor);
            let gqlres = results.data.vtuber;
            fetchedPage++;
            let expectedTotal = Math.ceil(gqlres.upcoming._total / gqlres.upcoming.pageInfo.results_per_page);
            $("#loading-text").text(`Loading (${fetchedPage}/${expectedTotal})...`);

            let mainResults = gqlres.upcoming.items;

            let pageData = gqlres.upcoming.pageInfo;
            if (pageData.hasNextPage && pageData.nextCursor) {
                console.log(`[API] Next page detected, paginating...`);
                return mainResults.concat(await getAllLivesAsync(pageData.nextCursor));
            } else {
                return mainResults;
            }
        }

        const PLACEHOLDER_IMG = `data:image/svg+xml,%3Csvg viewBox='0 0 1280 720' xmlns='http://www.w3.org/2000/svg'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='%23262626'/%3E%3C/svg%3E`;

        function createCard(channelInfo) {
            // console.log(channelInfo);
            let $chanCol = $(`<div class="col-sm-6" />`);
            let $cardMain, watchUrl;
            if (channelInfo.platform === "youtube") {
                $cardMain = $(`<div class="card border border-danger text-white bg-dark" />`);
                watchUrl = `https://youtube.com/watch?v=${channelInfo.id}`;
            }
            let $linkClick = $(`<a href="${watchUrl}" target="_blank" rel="noopener" />`)
                .append($(`<img class="card-img-top lazy" />`).attr("data-src", channelInfo.thumbnail).attr("alt",
                    "Thumbnail").attr("src", PLACEHOLDER_IMG));
            $cardMain.append($linkClick);
            let $cardMainBody = $(`<div class="card-body" />`);
            let is_premiere = get(channelInfo, "is_premiere", false);
            if (channelInfo.platform === "youtube") {
                $cardMainBody.append($(`<i class="ihaicon mx-1 text-danger" />`).text("youtube_icon"));
                if (is_premiere) {
                    $cardMainBody.append($(`<i class="ihaicon mx-1 text-info" />`).text("play_icon"));
                }
                $cardMainBody.append($(`<span />`).text(is_premiere ? "YouTube (Premiere)" : "YouTube"));
            }

            $cardMainBody.append($(`<h5 class="card-title" />`).text(channelInfo.title));
            $cardMainBody.append($(`<p class="card-subtitle"><b>Streamer:</b> ${channelInfo.channel.name}</p>`));
            let startTimeTZ = DateTime.fromSeconds(channelInfo.timeData.scheduledStartTime, {
                zone: "UTC"
            }).setZone(localZone);
            let startTimeTXT = startTimeTZ.toFormat("EEE, dd MMM yyyy HH:mm:ss ZZZZ");
            let $statsCard = $(
                `<p class="card-text"><b>Start:</b> ${startTimeTXT}</p>`
            );

            let $linkCard = $(
                    `<a class="btn btn-danger" href="${watchUrl}" role="button" rel="noopener" target="_blank" />`)
                .text("Watch");
            $cardMainBody.append($statsCard);
            $cardMainBody.append($linkCard);
            $cardMain.append($cardMainBody);

            $chanCol.append($cardMain)
            // $cardMain.appendTo($groupRows);
            return $chanCol;
        }

        function generateColumn(groupName, groupData) {
            let $topDiv = $(`<div id="${groupName}" class="container-fluid pb-3" />`);
            $topDiv.append($(
                `<h2 class="text-white py-3">${get(GROUPS_NAME_MAP, groupName, groupName)} <span class="badge bg-danger fs-5 fw-normal">${groupData.length}</span></h2>`
            ));
            let $groupRows = $(`<div class="row row-cols-1 row-cols-md-2 g-4" />`);
            let liveCards = sortBy(groupData, function (o) {
                return o.timeData.scheduledStartTime;
            }).map(createCard);
            liveCards.forEach(($card) => {
                $groupRows.append($card);
            })
            $topDiv.append($groupRows);
            return $topDiv;
        }

        (async () => {
            console.log("[API] Fetching all channels data...");
            const channelsSets = await getAllLivesAsync();
            console.log("[API] Grouping results...");
            let unsortedGroupedData = groupBy(channelsSets, "group");
            let groupedData = {};
            Object.keys(unsortedGroupedData).sort().forEach(function (key) {
                groupedData[key] = unsortedGroupedData[key];
            })
            let allJQData = [];

            Object.keys(groupedData).sort().forEach(function (group) {
                $gridModal.append($(
                    `<a class="btn btn-dark btn-darkgrey" href="#${group}" role="button">${get(GROUPS_NAME_MAP, group, group)} <span class="badge bg-danger mx-1 rounded-0">${groupedData[group].length}</span></a>`
                ));
            })

            for (let key in groupedData) {
                let value = groupedData[key];
                let $r = generateColumn(key, value);
                allJQData.push($r);
            }
            $loader.fadeOut(500);
            allJQData.forEach(($jqd) => {
                $jqd.show();
                $main.append($jqd);
            })

            var lazyLoadInstance = new LazyLoad({});
            lazyLoadInstance.update();
        })();
    </script>
</body>

</html>